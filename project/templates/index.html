{% extends "base.html" %}

{% block title %} OurTieba {% endblock %}

{% block page_content %}

    {#    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel" style="overflow: hidden">#}
    {#        <div class="carousel-indicators">#}
    {#            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active"#}
    {#                    aria-current="true" aria-label="Slide 1"></button>#}
    {#            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1"#}
    {#                    aria-label="Slide 2"></button>#}
    {#            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2"#}
    {#                    aria-label="Slide 3"></button>#}
    {#        </div>#}
    {#        <div class="carousel-inner">#}
    {#            {% for news in data['news'] %}#}
    {#            <div class="carousel-item {% if loop.first %}active{% endif %}" data-bs-interval="5000">#}
    {#                <img src="{{ news['img_src'] }}" class="d-block w-100">#}
    {#                <div class="carousel-caption d-none d-md-block">#}
    {#                    <h5>{{ news['title'] }}</h5>#}
    {#                    <p>{{ news['abstract'] }} </p>#}
    {#                </div>#}
    {#            </div>#}
    {#            {% endfor %}#}
    {#            <div class="carousel-item" data-bs-interval="5000">#}
    {#                <img src="{{ data['news'][0]['img_src'] }}" class="d-block w-100">#}
    {#                <div class="carousel-caption d-none d-md-block">#}
    {#                    <h5>Second slide label</h5>#}
    {#                    <p>Some representative placeholder content for the second slide.</p>#}
    {#                </div>#}
    {#            </div>#}
    {#            <div class="carousel-item" data-bs-interval="5000">#}
    {#                <img src="{{ data['news'][0]['img_src'] }}" class="d-block w-100">#}
    {#                <div class="carousel-caption d-none d-md-block">#}
    {#                    <h5>Third slide label</h5>#}
    {#                    <p>Some representative placeholder content for the third slide.</p>#}
    {#                </div>#}
    {#            </div>#}
    {#        </div>#}
    {#        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"#}
    {#                data-bs-slide="prev">#}
    {#            <span class="carousel-control-prev-icon"></span>#}
    {#            <span class="visually-hidden">Previous</span>#}
    {#        </button>#}
    {#        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"#}
    {#                data-bs-slide="next">#}
    {#            <span class="carousel-control-next-icon"></span>#}
    {#            <span class="visually-hidden">Next</span>#}
    {#        </button>#}
    {#    </div>#}


    <div class="page-header">
        <div class="p-4 p-md-5 mb-4 text-white rounded bg-dark">
            <div class="col-md-6 px-0">
                <h1 class="display-4 fst-italic">{{ data['news'][0]['title'] }}</h1>
                <p class="lead my-3">{{ data['news'][0]['abstract'] }}</p>
                <p class="lead mb-0"><a href="{{ data['news'][0]['link'] }}" class="text-white fw-bold">Continue
                    reading...</a></p>
            </div>
        </div>
    </div>
    <div class="row mb-2">
        {% for news in data['news'][1:] %}
            <div class="col-md-6">
                <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                    <div class="col p-4 d-flex flex-column position-static">
                        <h3 class="mb-0">Featured post</h3>
                        <div class="mb-1 text-muted">Nov 12</div>
                        <p class="card-text mb-auto">This is a wider card with supporting text below as a natural
                            lead-in to
                            additional content.</p>
                        <a href="#" class="stretched-link">Continue reading</a>
                    </div>
                    <div class="col-auto d-none d-lg-block">
                        {#                    <svg class="bd-placeholder-img" width="200" height="250" xmlns="http://www.w3.org/2000/svg"#}
                        {#                         role="img" aria-label="Placeholder: Thumbnail" preserveAspectRatio="xMidYMid slice"#}
                        {#                         focusable="false"><title>Placeholder</title>#}
                        {#                        <rect width="100%" height="100%" fill="#55595c"></rect>#}
                        {#                        <text x="50%" y="50%" fill="#eceeef" dy=".3em">Thumbnail</text>#}
                        {#                    </svg>#}
                        <img src="{{ news['img_src'] }}" alt="" height="250" width="200" style="object-fit: cover; object-position: center">

                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <br>
    <h4>Upload User Avatar</h4>
    <input type="file" accept="image/*" onchange="uploadImg(this.files[0]);">
    <hr>
    <div class="display-4">Hot Boards</div>
    <hr>

    {% for board in data['boards'] %}
        <article class="post">
            <header>
                <div>
                    <a href="/board/{{ board['Bid'] }}" class="text-decoration-none display-6">{{ board['name'] }}</a>
                    <div class="accordion-body">Board ID: {{ board['Bid'] }}</div>
                    <div class="accordion-body">Post count: {{ board['post_count'] }}</div>

                </div>
            </header>
            <p class="body">{{ board['summary'] }}</p>
        </article>
        {% if not loop.last %}
            <hr>
        {% endif %}
    {% endfor %}


    <script>
        function uploadImg(file) {
            if (file.type.substr(0, 5) !== "image") {
                alert("Invalid File Type!");
                return;
            }
            if (file.size > (3 * 1024 * 1024)) {
                alert("Image Too Large!");
                return;
            }
            var formData = new FormData();
            formData.append("file", file);
            $.ajax({
                method: "post",
                url: "/api/upload",
                data: formData,
                processData: false,
                contentType: false,
                success: (data) => {
                    if (data.hasOwnProperty("status")) {
                        alert("Successfully uploaded image!");
                        location.reload();
                    } else {
                        alert(data.error.msg);
                    }
                }
            })
        }
    </script>
{% endblock %}
